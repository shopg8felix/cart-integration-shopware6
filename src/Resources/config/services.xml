<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd">
    <parameters>
        <parameter key="shopgate.action.whitelist" type="collection">
            <parameter key="enable_get_settings">true</parameter>
            <parameter key="enable_set_settings">true</parameter>
            <parameter key="enable_get_categories">true</parameter>
            <parameter key="enable_get_customer">true</parameter>
            <parameter key="enable_get_reviews">true</parameter>
            <parameter key="enable_get_items">true</parameter>
            <parameter key="enable_register_customer">true</parameter>
            <parameter key="enable_check_cart">true</parameter>
            <parameter key="enable_add_order">true</parameter>
            <parameter key="enable_cron">true</parameter>
        </parameter>
        <!-- Note that whitelists control mapping of $sgEntity->custom_fields[]->field to existing $swEntity->field. -->
        <!-- Whatever does not map here goes into the $swEntity->customFields list, it will only save if the field exists. -->
        <parameter key="shopgate.customer.custom_field.whitelist" type="collection">
            <parameter key="title">string</parameter>
            <parameter key="affiliateCode">string</parameter>
            <parameter key="campaignCode">string</parameter>
            <parameter key="vatIds">array</parameter><!-- Req. accountType=business & billingAddress->company -->
            <parameter key="accountType">string</parameter> <!-- see constants at Shopware\Core\Checkout\Customer -->
        </parameter>
        <parameter key="shopgate.customer.address.custom_field.whitelist" type="collection">
            <parameter key="department">string</parameter>
        </parameter>
        <parameter key="shopgate.order.custom_field.whitelist" type="collection">
            <parameter key="affiliateCode">string</parameter>
            <parameter key="campaignCode">string</parameter>
            <parameter key="customerComment">string</parameter>
        </parameter>
    </parameters>
    <services>
        <defaults autoconfigure="true" autowire="true"/>
        <service id="Shopgate\Shopware\Catalog\Category\CategoryBridge"/>
        <service id="Shopgate\Shopware\Catalog\Category\CategoryComposer"/>
        <service id="Shopgate\Shopware\Catalog\Product\ProductBridge"/>
        <service id="Shopgate\Shopware\Catalog\Product\ProductComposer"/>
        <service id="Shopgate\Shopware\Catalog\Review\ReviewComposer"/>
        <service id="Shopgate\Shopware\Catalog\Review\ReviewBridge">
            <argument key="$reviewRepository" type="service" id="product_review.repository"/>
        </service>
        <service id="Shopgate\Shopware\Catalog\Review\ReviewMapping"/>
        <service id="Shopgate\Shopware\Customer\CustomerComposer"/>
        <service id="Shopgate\Shopware\Customer\AddressBridge">
            <argument key="$addressRepository" type="service" id="customer_address.repository"/>
        </service>
        <service id="Shopgate\Shopware\Customer\CustomerBridge"/>
        <service id="Shopgate\Shopware\Catalog\Mapping\ChildProductMapping"/>
        <service id="Shopgate\Shopware\Catalog\Mapping\ConfigProductMapping"/>
        <service id="Shopgate\Shopware\Catalog\Mapping\ProductMapFactory"/>
        <service id="Shopgate\Shopware\Catalog\Mapping\SimpleProductMapping"/>
        <service id="Shopgate\Shopware\Catalog\Mapping\TierPriceMapping"/>
        <service id="Shopgate\Shopware\Catalog\Product\Property\CustomFieldBridge">
            <argument type="service" id="custom_field.repository"/>
        </service>
        <service id="Shopgate\Shopware\Catalog\Product\Property\PropertyBridge">
            <argument type="service" id="property_group.repository"/>
        </service>
        <service id="Shopgate\Shopware\Catalog\Product\Sort\SortBridge">
            <argument type="service" id="product_sorting.repository"/>
        </service>
        <service id="Shopgate\Shopware\Catalog\Product\Subscribers\ProductUpdateSubscriber">
            <tag name="kernel.event_subscriber"/>
        </service>
        <service id="Shopgate\Shopware\Catalog\Product\Sort\SortTree"/>
        <service id="Shopgate\Shopware\Customer\Mapping\SalutationMapping">
            <argument type="service" id="salutation.repository"/>
            <argument type="service" id="Shopgate\Shopware\Storefront\ContextManager"/>
        </service>
        <service id="Shopgate\Shopware\Customer\Mapping\AddressMapping">
            <argument key="$customFieldMapping" type="service" id="sg.customer.address.custom_field.whitelist"/>
        </service>
        <service id="Shopgate\Shopware\Customer\Mapping\CustomerMapping">
            <argument key="$customFieldMapping" type="service" id="sg.customer.custom_field.whitelist"/>
        </service>
        <service id="Shopgate\Shopware\Order\Quote\OrderMapping">
            <argument key="$customFieldMapping" type="service" id="sg.order.custom_field.whitelist"/>
        </service>
        <service id="Shopgate\Shopware\Customer\Mapping\GroupMapping"/>
        <service id="Shopgate\Shopware\Customer\Mapping\LocationMapping">
            <argument type="service" id="country.repository"/>
            <argument type="service" id="country_state.repository"/>
            <argument type="service" id="Shopgate\Shopware\Storefront\ContextManager"/>
        </service>
        <service id="Shopgate\Shopware\ExportService"/>
        <service id="Shopgate\Shopware\ImportService"/>
        <service id="Shopgate\Shopware\Order\Customer\AddressComposer"/>
        <service id="Shopgate\Shopware\Order\Subscriber\AddSgOrderToCriteriaSubscriber">
            <tag name="kernel.event_subscriber"/>
        </service>
        <service id="Shopgate\Shopware\Order\CartComposer"/>
        <service id="Shopgate\Shopware\Order\Customer\CustomerMapping"/>
        <service id="Shopgate\Shopware\Order\Customer\OrderCustomerComposer"/>
        <service id="Shopgate\Shopware\Order\ContextComposer"/>
        <service id="Shopgate\Shopware\Order\LineItem\LineItemComposer"/>
        <service id="Shopgate\Shopware\Order\LineItem\LineItemProductMapping"/>
        <service id="Shopgate\Shopware\Order\LineItem\LineItemPromoMapping"/>
        <service id="Shopgate\Shopware\Order\Quote\QuoteErrorMapping"/>
        <service id="Shopgate\Shopware\Order\OrderComposer"/>
        <service id="Shopgate\Shopware\Order\Payment\PaymentBridge"/>
        <service id="Shopgate\Shopware\Order\Payment\PaymentComposer"/>
        <service id="Shopgate\Shopware\Order\Payment\PaymentMapping"/>
        <service id="Shopgate\Shopware\Order\Shipping\ShippingMapping"/>
        <service id="Shopgate\Shopware\Order\Shipping\ShippingComposer"/>
        <service id="Shopgate\Shopware\Order\Shipping\ShippingMethodBridge"/>
        <service id="Shopgate\Shopware\Order\Quote\QuoteBridge"/>
        <service id="Shopgate\Shopware\Shopgate\NativeOrderExtension">
            <tag name="shopware.entity.extension"/>
        </service>
        <service id="Shopgate\Shopware\Shopgate\ExtendedClassFactory"/>
        <service id="Shopgate\Shopware\Shopgate\Extended\ExtendedCartItem"/>
        <service id="Shopgate\Shopware\Shopgate\Order\ShopgateOrderDefinition">
            <tag name="shopware.entity.definition" entity="shopgate_order"/>
        </service>
        <service id="Shopgate\Shopware\Shopgate\RequestPersist" shared="true"/>
        <service id="Shopgate\Shopware\Shopgate\ShopgateOrderBridge">
            <argument type="service" id="shopgate_order.repository"/>
        </service>
        <service id="Shopgate\Shopware\System\DomainBridge">
            <argument type="service" id="sales_channel_domain.repository"/>
        </service>
        <service id="Shopgate\Shopware\System\Configuration\ConfigBridge">
            <argument type="service" id="plugin.repository"/>
            <argument type="string">%kernel.shopware_version%</argument>
            <argument type="service" id="Shopgate\Shopware\Storefront\ContextManager"/>
            <argument type="service" id="Shopware\Core\System\SystemConfig\SystemConfigService"/>
            <argument type="service" id="system_config.repository"/>
        </service>
        <service id="sg.order.custom_field.whitelist" class="Shopgate\Shopware\System\CustomFields\CustomFieldMapping">
            <argument key="$whitelist">%shopgate.order.custom_field.whitelist%</argument>
        </service>
        <service id="sg.customer.custom_field.whitelist" class="Shopgate\Shopware\System\CustomFields\CustomFieldMapping">
            <argument key="$whitelist">%shopgate.customer.custom_field.whitelist%</argument>
        </service>
        <service id="sg.customer.address.custom_field.whitelist" class="Shopgate\Shopware\System\CustomFields\CustomFieldMapping">
            <argument key="$whitelist">%shopgate.customer.address.custom_field.whitelist%</argument>
        </service>
        <service id="Shopgate\Shopware\System\CustomFields\CustomFieldMapping"
                 alias="sg.customer.custom_field.whitelist"/>
        <service id="Shopgate\Shopware\System\FileCache">
            <argument>shopgate</argument>
            <argument>86400</argument>
            <argument>%kernel.cache_dir%</argument>
        </service>
        <service id="Shopgate\Shopware\System\Log\Logger"/>
        <service id="Shopgate\Shopware\System\Db\Rule\IsShopgateRuleCondition">
            <tag name="shopware.rule.definition"/>
        </service>
        <service id="Shopgate\Shopware\System\Tax\TaxBridge">
            <argument type="service" id="tax.repository"/>
            <argument type="service" id="tax_rule.repository"/>
            <argument type="service" id="tax_rule_type.repository"/>
            <argument type="service" id="Shopgate\Shopware\Storefront\ContextManager"/>
        </service>
        <service id="Shopgate\Shopware\System\PaymentHandler\GenericHandler">
            <argument type="service"
                      id="Shopware\Core\Checkout\Order\Aggregate\OrderTransaction\OrderTransactionStateHandler"/>
            <tag name="shopware.payment.method.sync"/>
        </service>
        <service id="Shopgate\Shopware\System\PaymentHandler\PaymentLoaderSubscriber">
            <tag name="kernel.event_subscriber"/>
        </service>
        <service id="Shopgate\Shopware\System\Formatter"/>
        <service id="Shopgate\Shopware\System\Tax\TaxComposer"/>
        <service id="Shopgate\Shopware\Storefront\ContextManager">
            <argument type="service" id="Shopware\Core\System\SalesChannel\Context\SalesChannelContextFactory"/>
            <argument type="service" id="Shopware\Core\System\SalesChannel\Context\SalesChannelContextService"/>
        </service>
        <service id="Shopware\Core\Framework\Validation\DataBag\RequestDataBag"/>
        <!-- Public (needed for controllers and classes instantiated via Facade class -->
        <service id="Shopgate\Shopware\System\Di\Forwarder" public="true"/>
        <service id="Shopgate\Shopware\Storefront\Controller\MainController" public="true"/>
        <!-- Interfaces -->
        <service id="Shopgate\Shopware\System\Log\LoggerInterface" alias="Shopgate\Shopware\System\Log\Logger"/>
        <service id="Shopware\Core\Content\Product\SalesChannel\CrossSelling\AbstractProductCrossSellingRoute"
                 alias="Shopware\Core\Content\Product\SalesChannel\CrossSelling\CachedProductCrossSellingRoute"/>
        <service id="Shopware\Core\Content\Product\SalesChannel\Listing\AbstractProductListingRoute"
                 alias="Shopware\Core\Content\Product\SalesChannel\Listing\ProductListingRoute"/>
        <service id="Shopware\Core\Content\Product\SalesChannel\AbstractProductListRoute"
                 alias="Shopware\Core\Content\Product\SalesChannel\ProductListRoute"/>
        <service id="Shopware\Core\System\SalesChannel\SalesChannel\AbstractContextSwitchRoute"
                 alias="Shopware\Core\System\SalesChannel\SalesChannel\ContextSwitchRoute"/>
        <service id="Shopware\Core\System\SalesChannel\Context\AbstractSalesChannelContextFactory"
                 alias="Shopware\Core\System\SalesChannel\Context\CachedSalesChannelContextFactory"/>
        <service id="Shopware\Core\System\Language\SalesChannel\AbstractLanguageRoute"
                 alias="Shopware\Core\System\Language\SalesChannel\CachedLanguageRoute"/>
        <service id="Shopware\Core\Checkout\Cart\SalesChannel\AbstractCartOrderRoute"
                 alias="Shopware\Core\Checkout\Cart\SalesChannel\CartOrderRoute"/>
        <service id="Shopware\Core\Checkout\Cart\SalesChannel\AbstractCartLoadRoute"
                 alias="Shopware\Core\Checkout\Cart\SalesChannel\CartLoadRoute"/>
        <service id="Shopware\Core\Checkout\Cart\SalesChannel\AbstractCartItemAddRoute"
                 alias="Shopware\Core\Checkout\Cart\SalesChannel\CartItemAddRoute"/>
        <service id="Shopware\Core\Checkout\Cart\SalesChannel\AbstractCartDeleteRoute"
                 alias="Shopware\Core\Checkout\Cart\SalesChannel\CartDeleteRoute"/>
        <service id="Shopware\Core\Checkout\Shipping\SalesChannel\AbstractShippingMethodRoute"
                 alias="Shopware\Core\Checkout\Shipping\SalesChannel\CachedShippingMethodRoute"/>
        <service id="Shopware\Core\Checkout\Customer\SalesChannel\AbstractCustomerRoute"
                 alias="Shopware\Core\Checkout\Customer\SalesChannel\CustomerRoute"/>
        <service id="Shopware\Core\Checkout\Customer\SalesChannel\AbstractLoginRoute"
                 alias="Shopware\Core\Checkout\Customer\SalesChannel\LoginRoute"/>
        <service id="Shopware\Core\Checkout\Customer\SalesChannel\AbstractRegisterRoute"
                 alias="Shopware\Core\Checkout\Customer\SalesChannel\RegisterRoute"/>
        <service id="Shopware\Core\Checkout\Customer\SalesChannel\AbstractUpsertAddressRoute"
                 alias="Shopware\Core\Checkout\Customer\SalesChannel\UpsertAddressRoute"/>
        <service id="Shopware\Core\Content\Category\SalesChannel\AbstractCategoryListRoute"
                 alias="Shopware\Core\Content\Category\SalesChannel\CategoryListRoute"/>
        <service id="Shopware\Core\Checkout\Payment\SalesChannel\AbstractPaymentMethodRoute"
                 alias="Shopware\Core\Checkout\Payment\SalesChannel\PaymentMethodRoute"/>
    </services>
</container>
